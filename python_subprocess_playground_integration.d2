direction: down

title: {
  label: "**Speech App Flow (High-Level)**"
}

user: {
  label: "**User**\nSpeaks and taps controls"
  style.fill: "#F1F5F9"
}

app: {
  label: "**Web App (LiveView)**\nCoordinates recording, AI response, and playback"
  style.fill: "#E8F1FF"
}

stt: {
  label: "**Speech-to-Text Worker (Python + voxmlx)**\nTurns live audio into transcript text"
  style.fill: "#EAF9EE"
}

dspy: {
  label: "**AI Text Transformer (DSPy + Ollama)**\nConverts transcript into better spoken output"
  style.fill: "#F3E8FF"
}

tts: {
  label: "**Text-to-Speech Worker (Python)**\nConverts response text into streamed audio"
  style.fill: "#FFF4E5"
}

browser: {
  label: "**Browser Audio Output**\nPlays generated speech"
  style.fill: "#FFF4E5"
}

user -> app: "Start/stop + microphone audio"
app -> stt: "Send audio for transcription"
stt -> app: "Return live/final transcript"
app -> dspy: "Ask AI to rewrite/shape response"
dspy -> app: "Return response text"
app -> tts: "Send response text to synthesize"
tts -> browser: "Stream playable speech audio"
browser -> user: "User hears spoken result"
